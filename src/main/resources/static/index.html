<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å…»é¸¡åœºæµ‹è¯•å° (äººæ€§åŒ–å¸ƒå±€ç‰ˆ)</title>
    <style>
        /* å…¨å±€é‡ç½® */
        * { box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', sans-serif;
            margin: 0; padding: 0;
            background-color: #f4f6f8;
            height: 100vh;
            display: flex; /* å·¦å³å¸ƒå±€æ ¸å¿ƒ */
            overflow: hidden; /* é˜²æ­¢æ•´ä¸ªé¡µé¢åŒé‡æ»šåŠ¨ */
        }

        /* === å·¦ä¾§ï¼šæ»šåŠ¨æ“ä½œåŒº === */
        .left-panel {
            flex: 1; /* å æ®å‰©ä½™ç©ºé—´ */
            padding: 20px;
            overflow-y: auto; /* å†…å®¹å¤šäº†å¯ä»¥æ»šåŠ¨ */
            height: 100%;
        }

        /* === å³ä¾§ï¼šå›ºå®šæ—¥å¿—åŒº === */
        .right-panel {
            width: 400px; /* å›ºå®šå®½åº¦ */
            background: #2b2b2b;
            color: #ccc;
            display: flex;
            flex-direction: column;
            border-left: 5px solid #007bff;
        }

        /* æ—¥å¿—å¤´éƒ¨ */
        .log-header {
            padding: 10px;
            background: #1e1e1e;
            border-bottom: 1px solid #444;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .log-title { font-weight: bold; color: #fff; }
        .clear-btn {
            font-size: 12px; padding: 4px 8px; background: #555; border: none;
            color: white; cursor: pointer; border-radius: 3px;
        }
        .clear-btn:hover { background: #777; }

        /* æ—¥å¿—å†…å®¹æ»šåŠ¨åŒº */
        #console-box {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            font-family: Consolas, monospace;
            font-size: 12px;
        }

        /* === å…·ä½“çš„å¡ç‰‡æ ·å¼ === */
        .box {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            max-width: 800px; /* é™åˆ¶æœ€å¤§å®½åº¦ï¼Œé˜²æ­¢å¤ªå®½éš¾çœ‹ */
            margin-left: auto; margin-right: auto; /* å±…ä¸­ */
        }
        .box h2 { margin-top: 0; font-size: 18px; color: #333; border-bottom: 2px solid #eee; padding-bottom: 10px; }

        /* è¡¨å•æ ·å¼ */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); /* è‡ªåŠ¨å¤šåˆ— */
            gap: 15px;
        }
        .form-item { display: flex; flex-direction: column; }
        .form-item label { font-size: 12px; font-weight: bold; color: #666; margin-bottom: 5px; }
        .form-item input { padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        .form-item input:focus { border-color: #007bff; outline: none; }

        /* æŒ‰é’®ç»„ */
        .btn-row { margin-top: 20px; text-align: right; }
        button {
            padding: 10px 20px; border: none; border-radius: 4px;
            background: #007bff; color: white; cursor: pointer; font-weight: 600;
            transition: 0.2s;
        }
        button:hover { background: #0056b3; }
        button.red { background: #dc3545; }
        button.red:hover { background: #a71d2a; }
        button.green { background: #28a745; }
        button.green:hover { background: #218838; }

        /* æ—¥å¿—é¢œè‰² */
        .log-entry { margin-bottom: 15px; border-bottom: 1px solid #444; padding-bottom: 10px; }
        .log-time { color: #888; margin-bottom: 4px; font-size: 11px; }
        .c-req { color: #61afef; } /* è“è‰²è¯·æ±‚ */
        .c-res { color: #98c379; } /* ç»¿è‰²å“åº” */
        .c-err { color: #e06c75; } /* çº¢è‰²é”™è¯¯ */

    </style>
</head>
<body>

<div class="left-panel">
    <h1 style="text-align:center; color:#444;">ğŸ£ å…»é¸¡åœºç®¡ç†ç³»ç»Ÿ - ç»ˆææµ‹è¯•å°</h1>

    <div class="box">
        <h2>ğŸ‘¤ 1. æ·»åŠ ç”¨æˆ· (User Register)</h2>
        <div class="form-grid">
            <div class="form-item"><label>æ˜µç§°*</label><input type="text" id="add_u_nick" value="æµ‹è¯•å‘˜01"></div>
            <div class="form-item"><label>å¯†ç *</label><input type="text" id="add_u_pwd" value="123456"></div>
            <div class="form-item"><label>æ€§åˆ«</label><input type="text" id="add_u_sex" value="ç”·"></div>
            <div class="form-item"><label>å¹´é¾„</label><input type="number" id="add_u_age" value="22"></div>
            <div class="form-item"><label>å¤´åƒURL</label><input type="text" id="add_u_img" value="a.jpg"></div>
            <div class="form-item"><label>ç­¾å</label><input type="text" id="add_u_imp" value="æµ‹è¯•ä¸“ç”¨"></div>
            <div class="form-item"><label>çˆ±å¥½</label><input type="text" id="add_u_hobby" value="ç¡è§‰"></div>
        </div>
        <div class="btn-row">
            <button onclick="doAddUser()">â• æäº¤æ³¨å†Œ</button>
        </div>
    </div>

    <div class="box">
        <h2>âœï¸ 2. ä¿®æ”¹ç”¨æˆ· (User Update)</h2>
        <div class="form-grid">
            <div class="form-item"><label style="color:red">ç›®æ ‡è´¦å·ID*</label><input type="number" id="upd_u_account" placeholder="å¿…å¡«"></div>
            <div class="form-item"><label>æ–°æ˜µç§°</label><input type="text" id="upd_u_nick" placeholder="ä¸æ”¹ç•™ç©º"></div>
            <div class="form-item"><label>æ–°å¯†ç </label><input type="text" id="upd_u_pwd"></div>
            <div class="form-item"><label>æ–°æ€§åˆ«</label><input type="text" id="upd_u_sex"></div>
            <div class="form-item"><label>æ–°å¹´é¾„</label><input type="number" id="upd_u_age"></div>
            <div class="form-item"><label>æ–°å¤´åƒ</label><input type="text" id="upd_u_img"></div>
            <div class="form-item"><label>æ–°ç­¾å</label><input type="text" id="upd_u_imp"></div>
            <div class="form-item"><label>æ–°çˆ±å¥½</label><input type="text" id="upd_u_hobby"></div>
        </div>
        <div class="btn-row">
            <button class="green" onclick="doUpdateUser()">ğŸ’¾ æäº¤ä¿®æ”¹</button>
        </div>
    </div>

    <div class="box">
        <h2>ğŸ” 3. ç”¨æˆ·æŸ¥è¯¢ä¸åˆ é™¤</h2>
        <div class="form-grid">
            <div class="form-item"><label>è´¦å·ID</label><input type="number" id="act_u_account" placeholder="è¾“å…¥è´¦å·"></div>
        </div>
        <div class="btn-row" style="gap:10px; display:flex; justify-content:flex-end;">
            <button onclick="doGetUserAll()">æŸ¥æ‰€æœ‰</button>
            <button onclick="doGetUserOne()">æŸ¥å•ä¸ª</button>
            <button class="red" onclick="doDeleteUser()">ğŸ—‘ï¸ åˆ é™¤</button>
        </div>
    </div>

    <div class="box" style="border-top: 4px solid #ffc107;">
        <h2>ğŸ” 4. æ·»åŠ é¸¡ (Chicken Add)</h2>
        <div class="form-grid">
            <div class="form-item"><label style="color:red">ä¸»äººè´¦å·ID*</label><input type="number" id="add_c_master" placeholder="å¿…å¡«"></div>
            <div class="form-item"><label>é¸¡æ˜µç§°</label><input type="text" id="add_c_nick" value="å°é»„é¸¡"></div>
            <div class="form-item"><label>å“è´¨</label><input type="text" id="add_c_per" value="SSR"></div>
            <div class="form-item"><label>å±æ€§</label><input type="text" id="add_c_prop" value="æˆ˜æ–—"></div>
            <div class="form-item"><label>æ—¶é•¿</label><input type="text" id="add_c_times" value="3å¹´"></div>
            <div class="form-item"><label>è¯„åˆ†</label><input type="text" id="add_c_rating" value="S"></div>
            <div class="form-item"><label>èº«é«˜</label><input type="text" id="add_c_h" value="50"></div>
            <div class="form-item"><label>ä½“é‡</label><input type="text" id="add_c_w" value="5"></div>
            <div class="form-item"><label>èƒ¸å›´</label><input type="text" id="add_c_b" value="20"></div>
            <div class="form-item"><label>é•¿åº¦</label><input type="text" id="add_c_l" value="30"></div>
        </div>
        <div class="btn-row">
            <button onclick="doAddCk()">â• æ·»åŠ é¸¡</button>
        </div>
    </div>

    <div class="box" style="border-top: 4px solid #ffc107;">
        <h2>ğŸ› ï¸ 5. ä¿®æ”¹é¸¡ (Chicken Update)</h2>
        <div class="form-grid">
            <div class="form-item"><label style="color:red">ä¸»äººè´¦å·ID*</label><input type="number" id="upd_c_master" placeholder="å¿…å¡«"></div>
            <div class="form-item"><label>æ–°æ˜µç§°</label><input type="text" id="upd_c_nick" placeholder="ä¸æ”¹ç•™ç©º"></div>
            <div class="form-item"><label>æ–°å“è´¨</label><input type="text" id="upd_c_per"></div>
            <div class="form-item"><label>æ–°å±æ€§</label><input type="text" id="upd_c_prop"></div>
            <div class="form-item"><label>æ–°æ—¶é•¿</label><input type="text" id="upd_c_times"></div>
            <div class="form-item"><label>æ–°è¯„åˆ†</label><input type="text" id="upd_c_rating"></div>
            <div class="form-item"><label>æ–°èº«é«˜</label><input type="text" id="upd_c_h"></div>
            <div class="form-item"><label>æ–°ä½“é‡</label><input type="text" id="upd_c_w"></div>
            <div class="form-item"><label>æ–°èƒ¸å›´</label><input type="text" id="upd_c_b"></div>
            <div class="form-item"><label>æ–°é•¿åº¦</label><input type="text" id="upd_c_l"></div>
        </div>
        <div class="btn-row">
            <button class="green" onclick="doUpdateCk()">ğŸ’¾ æäº¤ä¿®æ”¹</button>
        </div>
    </div>

    <div class="box" style="border-top: 4px solid #ffc107;">
        <h2>ğŸ— 6. é¸¡æŸ¥è¯¢ä¸åˆ é™¤</h2>
        <div class="form-grid">
            <div class="form-item"><label>ä¸»äººè´¦å·ID</label><input type="number" id="act_c_master" placeholder="è¾“å…¥è´¦å·"></div>
        </div>
        <div class="btn-row" style="gap:10px; display:flex; justify-content:flex-end;">
            <button onclick="doGetCkAll()">æŸ¥æ‰€æœ‰</button>
            <button onclick="doGetCkOne()">æŸ¥å•ä¸ª</button>
            <button class="red" onclick="doDeleteCk()">ğŸ—‘ï¸ åˆ é™¤</button>
        </div>
    </div>

    <br><br><br>
</div>

<div class="right-panel">
    <div class="log-header">
        <span class="log-title">ğŸ“¡ äº¤äº’æ—¥å¿—</span>
        <button class="clear-btn" onclick="document.getElementById('console-box').innerHTML=''">æ¸…ç©ºæ—¥å¿—</button>
    </div>
    <div id="console-box">
        <div style="color:#666; text-align:center; margin-top:50px;">
            ğŸš€ ç­‰å¾…æ“ä½œ...<br>è¯·ç‚¹å‡»å·¦ä¾§æŒ‰é’®
        </div>
    </div>
</div>

<script>
    const API_URL = "http://localhost:8080";

    // æ‰“å°æ—¥å¿—
    function log(title, data, type) {
        const box = document.getElementById('console-box');

        // å¦‚æœæ˜¯ç¬¬ä¸€æ¡ï¼Œæ¸…ç©ºé»˜è®¤æç¤º
        if(box.innerHTML.includes("ç­‰å¾…æ“ä½œ")) box.innerHTML = "";

        const time = new Date().toLocaleTimeString();
        let content = typeof data === 'object' ? JSON.stringify(data, null, 2) : data;

        let colorClass = 'c-req';
        if(type === 'success') colorClass = 'c-res';
        if(type === 'error') colorClass = 'c-err';

        const html = `
            <div class="log-entry">
                <div class="log-time">[${time}] ${title}</div>
                <pre class="${colorClass}" style="white-space:pre-wrap; margin:0;">${content}</pre>
            </div>
        `;
        box.insertAdjacentHTML('afterbegin', html); // æ–°æ—¥å¿—æ’åœ¨æœ€ä¸Šé¢
    }

    // é€šç”¨è¯·æ±‚
    async function send(path, method, bodyData) {
        const url = API_URL + path;
        log(`ğŸ“¡ å‘é€ ${method}`, url);

        const options = {
            method: method,
            headers: { 'Content-Type': 'application/json' }
        };

        if (bodyData && method !== 'GET') {
            const cleanData = {};
            for (let key in bodyData) {
                if (bodyData[key] !== null && bodyData[key] !== "") {
                    cleanData[key] = bodyData[key];
                }
            }
            options.body = JSON.stringify(cleanData);
            log("ğŸ“¦ å‘é€ Body", cleanData);
        }

        try {
            const res = await fetch(url, options);
            const json = await res.json();

            if(json.code === 1 || json.code === 200) {
                log("âœ… æˆåŠŸ", json, 'success');
            } else {
                log("âŒ å¤±è´¥", json.msg || json, 'error');
                // åªæœ‰å¤±è´¥æ—¶æ‰å¼¹çª—æé†’ï¼ŒæˆåŠŸå°±ä¸å¼¹äº†ï¼Œçœ‹æ—¥å¿—å³å¯
                alert("æŠ¥é”™å•¦: " + (json.msg || "æœªçŸ¥é”™è¯¯"));
            }
        } catch (err) {
            log("â›” ç½‘ç»œé”™è¯¯", err, 'error');
            alert("è¯·æ±‚å‘ä¸å‡ºå»ï¼Œè¯·æ£€æŸ¥åç«¯æ˜¯å¦å¯åŠ¨ï¼");
        }
    }

    // ================= åŠŸèƒ½å‡½æ•° (é€»è¾‘ä¸å˜) =================

    function doAddUser() {
        send('/user', 'POST', {
            user_nick: val('add_u_nick'), user_pwd: val('add_u_pwd'), user_sex: val('add_u_sex'),
            user_age: val('add_u_age'), user_img: val('add_u_img'), user_imp: val('add_u_imp'), user_hobby: val('add_u_hobby')
        });
    }

    function doUpdateUser() {
        const acc = val('upd_u_account');
        if(!acc) return alert("æ²¡å¡«è´¦å·ï¼");
        send('/user?account=' + acc, 'PUT', {
            user_nick: val('upd_u_nick'), user_pwd: val('upd_u_pwd'), user_sex: val('upd_u_sex'),
            user_age: val('upd_u_age'), user_img: val('upd_u_img'), user_imp: val('upd_u_imp'), user_hobby: val('upd_u_hobby')
        });
    }

    function doGetUserAll() { send('/user', 'GET'); }
    function doGetUserOne() {
        const acc = val('act_u_account');
        if(!acc) return alert("æ²¡å¡«è´¦å·ï¼");
        send('/user/' + acc, 'GET');
    }
    function doDeleteUser() {
        const acc = val('act_u_account');
        if(!acc) return alert("æ²¡å¡«è´¦å·ï¼");
        if(confirm("åˆ äººä¼šè¿é¸¡ä¸€èµ·åˆ å“¦ï¼Œç¡®å®šï¼Ÿ")) send('/user/' + acc, 'DELETE');
    }

    function doAddCk() {
        const master = val('add_c_master');
        if(!master) return alert("æ²¡å¡«ä¸»äººè´¦å·ï¼");
        send('/ck?account=' + master, 'POST', {
            ck_nick: val('add_c_nick'), ck_per: val('add_c_per'), ck_property: val('add_c_prop'),
            ck_times: val('add_c_times'), ck_rating: val('add_c_rating'), ck_data_height: val('add_c_h'),
            ck_data_weight: val('add_c_w'), ck_data_breast: val('add_c_b'), ck_data_length: val('add_c_l')
        });
    }

    function doUpdateCk() {
        const master = val('upd_c_master');
        if(!master) return alert("æ²¡å¡«ä¸»äººè´¦å·ï¼");
        send('/ck?account=' + master, 'PUT', {
            ck_nick: val('upd_c_nick'), ck_per: val('upd_c_per'), ck_property: val('upd_c_prop'),
            ck_times: val('upd_c_times'), ck_rating: val('upd_c_rating'), ck_data_height: val('upd_c_h'),
            ck_data_weight: val('upd_c_w'), ck_data_breast: val('upd_c_b'), ck_data_length: val('upd_c_l')
        });
    }

    function doGetCkAll() { send('/ck', 'GET'); }
    function doGetCkOne() {
        const master = val('act_c_master');
        if(!master) return alert("æ²¡å¡«ä¸»äººè´¦å·ï¼");
        send('/ck/' + master, 'GET');
    }
    function doDeleteCk() {
        const master = val('act_c_master');
        if(!master) return alert("æ²¡å¡«ä¸»äººè´¦å·ï¼");
        if(confirm("ç¡®å®šæ€é¸¡ï¼Ÿ")) send('/ck/' + master, 'DELETE');
    }

    // ç®€ä¾¿è·å– value çš„å°å·¥å…·
    function val(id) {
        return document.getElementById(id).value;
    }

</script>
</body>
</html>